# Speckit Constitution 命令

## 命令描述
建立或更新專案憲章，確保所有相依模板保持同步。

## 使用方式
```bash
/speckit.constitution [使用者輸入]
```

## 功能說明

### 主要功能
1. **憲章管理**: 建立、更新或修訂專案憲章
2. **模板同步**: 確保所有相關模板與憲章保持一致
3. **版本控制**: 管理憲章的版本變更
4. **合規檢查**: 驗證專案活動是否符合憲章原則

### 支援的輸入格式
- 純文字描述
- 結構化原則定義
- 部分更新指令
- 完整憲章重寫

## 執行流程

### 1. 憲章載入
- 讀取現有憲章模板 `.specify/memory/constitution.md`
- 識別所有佔位符 `[ALL_CAPS_IDENTIFIER]`
- 分析使用者輸入需求

### 2. 內容收集
- 從使用者輸入提取值
- 從專案上下文推斷值
- 設定治理日期和版本號

### 3. 憲章更新
- 替換所有佔位符為具體內容
- 保持標題層級結構
- 確保原則清晰明確

### 4. 一致性傳播
- 更新計畫模板 `.specify/templates/plan-template.md`
- 更新規格模板 `.specify/templates/spec-template.md`
- 更新任務模板 `.specify/templates/tasks-template.md`
- 更新命令文件 `.specify/templates/commands/*.md`

### 5. 同步影響報告
產生包含以下內容的報告：
- 版本變更記錄
- 修改的原則清單
- 新增/移除的章節
- 需要更新的模板狀態
- 後續待辦事項

## 版本控制政策

### 語義版本控制
- **主版本號（MAJOR）**: 向後不相容的治理變更
- **次版本號（MINOR）**: 新增原則或重大擴展
- **修訂版本號（PATCH）**: 澄清說明或非語義性改進

### 版本決策流程
1. 分析變更影響範圍
2. 評估向後相容性
3. 決定版本號增量
4. 記錄變更理由

## 驗證檢查

### 內容驗證
- [ ] 無未解釋的佔位符
- [ ] 版本號與報告一致
- [ ] 日期格式正確（YYYY-MM-DD）
- [ ] 原則清晰且可測試

### 格式驗證
- [ ] Markdown 標題層級正確
- [ ] 行長度適中（<100 字元）
- [ ] 段落間距一致
- [ ] 無尾隨空白

## 錯誤處理

### 常見錯誤
1. **缺少關鍵資訊**: 插入 TODO 標記並記錄在報告中
2. **格式錯誤**: 提供修正建議
3. **版本衝突**: 提示解決方案
4. **模板不一致**: 自動同步或標記待處理

### 恢復機制
- 保留原始憲章備份
- 提供回滾選項
- 記錄所有變更歷史

## 輸出格式

### 成功輸出
```
✅ 憲章已成功更新至版本 X.Y.Z
📝 已更新 [N] 個模板文件
📊 同步影響報告已生成
💡 建議提交訊息: "docs: amend constitution to vX.Y.Z (principle additions + governance update)"
```

### 警告輸出
```
⚠️ 發現 [N] 個需要手動處理的項目
📋 請檢查同步影響報告中的待辦事項
🔄 部分模板可能需要額外更新
```

### 錯誤輸出
```
❌ 憲章更新失敗
🔍 錯誤原因: [詳細錯誤訊息]
💡 建議解決方案: [解決步驟]
```

## 最佳實踐

### 使用建議
1. **定期更新**: 每月檢視憲章適用性
2. **團隊參與**: 確保所有成員了解變更
3. **文檔同步**: 及時更新相關文檔
4. **版本追蹤**: 記錄所有變更歷史

### 注意事項
- 重大變更需要團隊討論
- 保持原則簡潔明確
- 定期檢視合規性
- 及時處理技術債務

## 相關命令
- `/speckit.plan`: 建立專案計畫
- `/speckit.spec`: 建立功能規格
- `/speckit.tasks`: 管理開發任務
- `/speckit.visualize`: 產生進度視覺化
